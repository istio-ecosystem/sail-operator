[Return to Documentation Dir](../docs/README.md) # Path: docs/README.md

# Documentation Guidelines

## Introduction
This guide aims to set basic guidelines for writing documentation for the project. The documentation should be clear, concise, and easy to understand. It should be written in a way that is accessible to both technical and non-technical users.

## Documentation Structure
The documentation should be structured in a way that is easy to navigate. It should be divided into sections and subsections, with a table of contents at the beginning of the document. Each section should cover a specific topic, and each subsection should cover a specific aspect of that topic.

### Structure of the entire folder and new forlders
All the documentation lives unders the folder `docs` in the root of the project. The documentation is divided into the following sections:
- `guidelines`: Contains guidelines for writing documentation.
- `api-reference`: Contains the API reference documentation.
- `common`: Contains common documentation that is relevant to the entire project, for example: `create-and-configure-gateways`, `install-bookinfo-app`, etc. All the docs located here should be linked to from the main README.md file for easy access.
- `multicluster`: contains resources referenced in the README.md file for the multicluster setup.

Any new folder or file added to the documentation should be linked to from the main README.md and you should only create a new folder if the documentation is not relevant to the entire project or if it is a new section that does not fit into the existing structure. Also, new folder can contains resources that are referenced in the README.md to be able to run examples or to get more information about the project (Example `multicluster` folder).

### Table of Contents
For long documents, it is recommended to include a table of contents at the beginning of the document. The table of contents should list all the sections and subsections in the document.

### Headings
Use headings to break up the content into sections and subsections. Headings should be descriptive and should clearly indicate the topic of the section or subsection.

### Formatting
Use formatting to make the text more readable. Use bullet points for lists, code blocks for code snippets, and inline code for short code snippets. Use bold or italic text to highlight important points. Any topic that is important to the reader should be highlighted in some way.

### Links
Use links to reference other sections of the documentation, external resources, or related topics. Links should be descriptive and should clearly indicate the target of the link. Links should be used to provide additional information or context for the reader. Avoid the use of raw URLs in the documentation.

### Images
Use images to illustrate concepts and provide visual guidance. Images should be accompanied by explanations and annotations to help the reader understand the content. Images should be used to enhance the text and provide additional context for the reader and they are going to be stored in a `images` folder.

### Nomemclature
Use consistent terminology throughout the documentation. Use the same terms to refer to the same concepts and avoid using different terms to refer to the same concept. For this project, we are going to use the following terms:
- `Sail Operator` to refer to the Sail Operator project.
- `istio` to refer to the Istio service mesh upstream project.
- `Istio` to the resource created and managed by the Sail Operator.
- `IstioCNI` to refer to the Istio CNI resource managed by the Sail Operator.
- `istio-cni` to refer to the Istio CNI project.


### Examples
Use examples to illustrate concepts and provide practical guidance. Examples should be clear, concise, and easy to follow. They should be accompanied by explanations and annotations to help the reader understand the code. Also, the examples provided can be used to run automated tests over the example steps. This is going to be explained in the next section (TODO: Insert link here).

Use inline code blocks for short code snippets and code blocks for longer code examples. You will need to follow this rule to keep the documentation consistent regarding code blocks:
- Code blocks should be tagged with the appropriate language `bash` at the beginning of the block. For example:
```bash
kubectl edit pod my-pod
```
- Expected output should not be tagged with the language. For example:
For the command `kubectl get pods` you should see the following output:
```
NAME      READY   STATUS    RESTARTS   AGE
my-pod    1/1     Running   0          1m
```

## Automated Testing over the Documentation
Any documentation step need to be tested to ensure that the steps are correct and the user can follow them without any issue. To do this, we are going to use resulting scripts generated by the `hack/update-docs-scripts.sh` script. This script is going to generate a script for each documentation topic that contains the steps to be tested. The resulting scripts are going to be located in the `docs/scripts` folder and it is going to be named as the documentation topics with the `.sh` extension. 

To run the documation script generator you can simply run the following command:
```bash
make gen-docs-tests
```
Also, the make target is included inside the `make update` target to ensure that the documentation scripts are always up to date.

### Adding a topic example to the automation workflow
To add a new topic to the automation workflow you need to follow the next steps:
1. Add the init tag to the topics in the documentation file. This tag is going to be used to generate the script that is going to be used to run the tests. For example:
```markdown
#### Installing using the CLI
<!-- generate-docs-test-init Installing_the_operator_using_the_cli-->
```
This tag is going to be used to generate the script that is going to be used to run the tests and it contains two parts:
- `generate-docs-test-init`: This is the tag that is going to be used to generate the script.
- `Installing_the_operator_using_the_cli`: This is the name of the script that is going to be generated. So, in this section you will need to add the name of the script that is going to be generated. Keep it simple and use underscores to separate the words.

2. Add the end tag to the topics in the documentation file. This tag is going to be used to mark the end of the test inside the example. For example:
```markdown
<!-- generate-docs-test-end -->
### Installation from Source
```
*Note*: take into account that all the examples and comments between the init and end tags are going to be included in the script that is going to be generated. So, make sure that the examples are correct and the comments are clear. Also, take into account that the script generator take all the code block marked as `bash` or `sh` to set them as commands to be executed in the script. The rest of the comments or code block non marked with the proper tag are going to be used as comments in the resulting script.

3. Add setup and cleanup steps to the script. The setup steps are going to be added to the resulting script in the same place where the tag is located. Take into account that this setup and cleanup steps are prebuilt and if you need some adjustment or add a new one you will need to add then inside the `hack/update-docs-scripts.sh` script. Example:
```markdown
#### Example using the InPlace strategy

Prerequisites:
* Sail Operator is installed.
<!-- prebuilt install_sail_operator -->
```
This tag is going to add to the script the proper steps to install the operator before running the rest of the steps. Also, you can add a cleanup step to the script using the `uninstall_sail_operator` tag. This tag is going to be used to add the cleanup steps to the script.

*Important*: keep in mind that this prebuilt setups are being made to be used in multiple scripts, so, if you the validation or setup that you need to apply is not going to be used in more that one script, you will need to add the setup and cleanup steps directly to the documentation (Check next step for more information).

4. Add validations or custom setups to the script. If you need to add a custom setup or validation that is not included in the prebuilt setups you can add them directly to the documentation. For example:
```markdown
<!-- command kubectl get pods -n sail-operator -->
```

Also, you can use the prebuilt function wait to wait for a resource to be ready. For example:
```markdown
<!-- wait condition resourceType resourceName namespace -->
```
Note: this wait function is going to wait for the resource to be ready. The parameters are:
- `condition`: The condition to wait for. For example: `ready`, `running`, etc.
- `resourceType`: The type of the resource to wait for. For example: `pod`, `deployment`, etc.
- `resourceName`: The name of the resource to wait for.
- `namespace`: The namespace where the resource is located.

This validations steps are crucial to be able to properly run the test, if they are not being added the script has more chances to result in failures because for example of resources not ready. So, make sure that the validations are correct and the setup steps are properly added to the script. If you found that the setup steps are not correct or the validations are not working as expected, you can add a new issue to the project to get help from the maintainers.

5. Run the script generator. To run the generated script we have a prow job that runs `make update` and then runs all the test located in the `docs/scripts` folder. To be able to test your documentation you just need to create a PR and the prow job is going to run the tests for you.



